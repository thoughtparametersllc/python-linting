name: Python Linting
description: Run linting using pylint, black, and mypy.
author: Jason Miller

branding:
  icon: check-square
  color: green

inputs:
  python-version:
    description: Python version to use for linting. If not specified, uses the default Python available on the runner.
    required: false
    default: '3.x'

  requirements-file:
    description: Path to a requirements file to install before linting. If not specified, only pylint, black, and mypy will be installed.
    required: false
    default: ''

  pylint_options:
    description: The pylint options to pass to pylint.
    required: false

  black_options:
    description: The black options to pass to black.
    required: false

  mypy_options:
    description: The mypy options to pass to mypy.
    required: false

  badge-directory:
    description: Directory to save the generated SVG badges. Defaults to .github/badges.
    required: false
    default: '.github/badges'

  generate-badges:
    description: Generate and commit SVG badges to the repository. Defaults to false.
    required: false
    default: 'false'

  update-readme:
    description: Automatically update README.md with badge references. Defaults to false.
    required: false
    default: 'false'

  readme-path:
    description: Path to README.md file to update with badges. Defaults to README.md.
    required: false
    default: 'README.md'

  badge-style:
    description: Badge style - 'url' for GitHub URLs or 'path' for relative paths. Defaults to path.
    required: false
    default: 'path'

runs:
  using: composite
  steps:
    - name: Setup Python
      id: setup-python
      uses: actions/setup-python@v6
      with:
        python-version: ${{ inputs.python-version }}

    - name: Install Linting Tools
      id: install-linting-tools
      if: steps.setup-python.outcome == 'success'
      run: |
        echo "::notice file=action.yml,line=51::Installing pylint, black, and mypy."
        pip3 install pylint black mypy && echo "::notice file=action.yml,line=52::Linting tools installation completed." || { echo "::error file=action.yml,line=53::Linting tools installation failed."; exit 1; }
        if [ $? -eq 0 ]; then
          echo "::notice file=action.yml,line=54::Successfully installed pylint, black, and mypy."
        else
          echo "::error file=action.yml,line=55::Failed to install pylint, black, and mypy."
          exit 1
        fi
      shell: bash
      continue-on-error: false

    - name: Install Additional Requirements
      id: install-requirements
      if: inputs.requirements-file != '' && steps.setup-python.outcome == 'success'
      run: |
        echo "::notice file=action.yml,line=60::Installing additional requirements from ${{ inputs.requirements-file }}"
        if [ test -r "${{ inputs.requirements-file }}" ]; then
          pip3 install -r "${{ inputs.requirements-file }}" 2>&1 | tee requirements_output.txt && echo "::notice file=action.yml,line=61::Additional requirements installation completed." || { echo "::error file=action.yml,line=62::Additional requirements installation failed."; exit 1; }
        else
          echo "::warning file=action.yml,line=63::Requirements file not found: ${{ inputs.requirements-file }}"
          echo "::notice file=action.yml,line=64::Skipping additional requirements installation."
        fi
      shell: bash
      continue-on-error: true

    - name: Generate Requirements Failure Summary
      if: steps.setup-python.outcome == 'success' && steps.install-requirements.outcome == 'failure'
      run: |
        echo "::notice file=action.yml,line=73::Creating Requirements Installation Failure Summary in GitHub Step Summary."

        echo "## Requirements Installation (Failure) :warning:" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "*Failed to install additional requirements from ${{ inputs.requirements-file }}.*" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### Output" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo '```text' >> $GITHUB_STEP_SUMMARY
        cat requirements_output.txt >> $GITHUB_STEP_SUMMARY
        echo '```' >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY

        echo "::notice file=action.yml,line=91::Removing temporary requirements output file."
        rm -f requirements_output.txt && echo "::notice file=action.yml,line=93::Temporary requirements output file removed." || { echo "::warning file=action.yml,line=94::Failed to remove temporary requirements output file."; }
      shell: bash
    
    - name: Failure On Requirements Installation Issues
      if: steps.install-requirements.outcome == 'failure'
      run: |
        echo "::error file=action.yml,line=97::Failed to install additional requirements. Failing the action."
        exit 1
      shell: bash

    - name: Generate Requirements Success Summary
      if: steps.install-requirements.outcome == 'success'
      run: |
        echo "::notice file=action.yml,line=81::Creating Requirements Installation Success Summary in GitHub Step Summary."

        echo "## Requirements Installation (Success) :white_check_mark:" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "*Successfully installed additional requirements from ${{ inputs.requirements-file }}.*" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### Output" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo '```text' >> $GITHUB_STEP_SUMMARY
        cat requirements_output.txt >> $GITHUB_STEP_SUMMARY
        echo '```' >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY

        echo "::notice file=action.yml,line=99::Removing temporary requirements output file."
        rm -f requirements_output.txt && echo "::notice file=action.yml,line=101::Temporary requirements output file removed." || { echo "::warning file=action.yml,line=102::Failed to remove temporary requirements output file."; }
      shell: bash

    - name: Run Pylint
      id: run-pylint
      if: steps.install-linting-tools.outcome == 'success' && always()
      run: |
        if [[ -z "${{ inputs.pylint_options }}" ]]; then
          echo "::notice file=action.yml,line=66::No Pylint options provided, using default."
          pylint --reports=y --jobs=0 . 2>&1 | tee pylint_output.txt && echo "::notice file=action.yml,line=68::Pylint run completed." || { echo "::error file=action.yml,line=69::Pylint run failed."; exit 1; }
        else
          echo "::notice file=action.yml,line=68::Using Pylint options: ${{ inputs.pylint_options }}"
          pylint ${{ inputs.pylint_options }} --reports=y --jobs=0 . 2>&1 | tee pylint_output.txt && echo "::notice file=action.yml,line=70::Pylint run completed." || { echo "::error file=action.yml,line=71::Pylint run failed."; exit 1; }
        fi
      shell: bash
      continue-on-error: true

    - name: Generate Pylint Failure Summary
      if: steps.run-pylint.outcome == 'failure'
      run: |
        echo "::notice file=action.yml,line=112::Creating Pylint Failure Summary in GitHub Step Summary."

        echo "## Pylint (Failure) :warning:" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "*Issues found by pylint.*" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### Output" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo '```text' >> $GITHUB_STEP_SUMMARY
        cat pylint_output.txt >> $GITHUB_STEP_SUMMARY
        echo '```' >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY

        echo "::notice file=action.yml,line=85::Removing temporary pylint output file."
        rm -f pylint_output.txt && echo "::notice file=action.yml,line=87::Temporary pylint output file removed." || { echo "::warning file=action.yml,line=88::Failed to remove temporary pylint output file."; }
      shell: bash

    - name: Failure On Pylint Issues
      if: steps.run-pylint.outcome == 'failure'
      run: |
        echo "::error file=action.yml,line=121::Pylint found issues. Failing the action."
        exit 1
      shell: bash

    - name: Generate Pylint Success Summary
      if: steps.run-pylint.outcome == 'success'
      run: |
        echo "::notice file=action.yml,line=119::Creating Pylint Success Summary in GitHub Step Summary."

        echo "## Pylint (Success) :white_check_mark:" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "*No issues found by pylint.*" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### Output" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo '```text' >> $GITHUB_STEP_SUMMARY
        cat pylint_output.txt >> $GITHUB_STEP_SUMMARY
        echo '```' >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY

        echo "::notice file=action.yml,line=101::Removing temporary pylint output file."
        rm -f pylint_output.txt && echo "::notice file=action.yml,line=103::Temporary pylint output file removed." || { echo "::warning file=action.yml,line=104::Failed to remove temporary pylint output file."; }
      shell: bash

    - name: Run Black
      id: run-black
      if: steps.install-linting-tools.outcome == 'success' && always()
      run: |
        if [[ -z "${{ inputs.black_options }}" ]]; then
          echo "::notice file=action.yml,line=88::No Black options provided, using default."
          black --check . 2>&1 | tee black_output.txt && echo "::notice file=action.yml,line=90::Black run completed." || { echo "::error file=action.yml,line=91::Black run failed."; exit 1; }
        else
          echo "::notice file=action.yml,line=88::Running Black with options: ${{ inputs.black_options }}"
          black --check ${{ inputs.black_options }} . 2>&1 | tee black_output.txt && echo "::notice file=action.yml,line=90::Black run completed." || { echo "::error file=action.yml,line=91::Black run failed."; exit 1; }
        fi
      shell: bash
      continue-on-error: true


    - name: Generate Black Failure Summary
      if: steps.run-black.outcome == 'failure'
      run: |
        echo "::notice file=action.yml,line=140::Creating Black Failure Summary in GitHub Step Summary."

        echo "## Black (Failure) :warning:" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "*Issues found by black.*" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### Output" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo '```text' >> $GITHUB_STEP_SUMMARY
        cat black_output.txt >> $GITHUB_STEP_SUMMARY
        echo '```' >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY

        echo "::notice file=action.yml,line=132::Removing temporary black output file."
        rm -f black_output.txt && echo "::notice file=action.yml,line=134::Temporary black output file removed." || { echo "::warning file=action.yml,line=135::Failed to remove temporary black output file."; }
      shell: bash

    - name: Failure On Black Issues
      if: steps.run-black.outcome == 'failure'
      run: |
        echo "::error file=action.yml,line=149::Black found issues. Failing the action."
        exit 1
      shell: bash

    - name: Generate Black Success Summary
      if: steps.run-black.outcome == 'success'
      run: |
        echo "::notice file=action.yml,line=147::Creating Black Success Summary in GitHub Step Summary."

        echo "## Black (Success) :white_check_mark:" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "*No issues found by black.*" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### Output" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo '```text' >> $GITHUB_STEP_SUMMARY
        cat black_output.txt >> $GITHUB_STEP_SUMMARY
        echo '```' >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY

        echo "::notice file=action.yml,line=139::Removing temporary black output file."
        rm -f black_output.txt && echo "::notice file=action.yml,line=141::Temporary black output file removed." || { echo "::warning file=action.yml,line=142::Failed to remove temporary black output file."; }
      shell: bash

    - name: Run MyPy
      id: run-mypy
      if: steps.install-linting-tools.outcome == 'success' && always()
      run: |
        if [[ -z "${{ inputs.mypy_options }}" ]]; then
          echo "::notice file=action.yml,line=105::No MyPy options provided, using default."
          mypy . 2>&1 | tee mypy_output.txt
        else
          echo "::notice file=action.yml,line=108::Using MyPy options: ${{ inputs.mypy_options }}"
          mypy ${{ inputs.mypy_options }} . 2>&1 | tee mypy_output.txt && echo "::notice file=action.yml,line=110::MyPy run completed." || { echo "::error file=action.yml,line=111::MyPy run failed."; exit 1; }
        fi
      shell: bash
      continue-on-error: true

    - name: Generate MyPy Failure Summary
      if: steps.run-mypy.outcome == 'failure'
      run: |
        echo "::notice file=action.yml,line=172::Creating MyPy Failure Summary in GitHub Step Summary."

        echo "## MyPy (Failure) :warning:" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "*Issues found by mypy.*" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### Output" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo '```text' >> $GITHUB_STEP_SUMMARY
        cat mypy_output.txt >> $GITHUB_STEP_SUMMARY
        echo '```' >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY

        echo "::notice file=action.yml,line=164::Removing temporary mypy output file."
        rm -f mypy_output.txt && echo "::notice file=action.yml,line=166::Temporary mypy output file removed." || { echo "::warning file=action.yml,line=167::Failed to remove temporary mypy output file."; }
      shell: bash

    - name: Failure On MyPy Issues
      if: steps.run-mypy.outcome == 'failure'
      run: |
        echo "::error file=action.yml,line=181::MyPy found issues. Failing the action."
        exit 1
      shell: bash

    - name: Generate MyPy Success Summary
      if: steps.run-mypy.outcome == 'success'
      run: |
        echo "::notice file=action.yml,line=179::Creating MyPy Success Summary in GitHub Step Summary."

        echo "## MyPy (Success) :white_check_mark:" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "*No issues found by mypy.*" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### Output" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo '```text' >> $GITHUB_STEP_SUMMARY
        cat mypy_output.txt >> $GITHUB_STEP_SUMMARY
        echo '```' >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY

        echo "::notice file=action.yml,line=154::Removing temporary mypy output file."
        rm -f mypy_output.txt && echo "::notice file=action.yml,line=156::Temporary mypy output file removed." || { echo "::warning file=action.yml,line=157::Failed to remove temporary mypy output file."; }
      shell: bash

    - name: Generate SVG Badges
      id: generate-badges
      if: steps.install-linting-tools.outcome == 'success' && inputs.generate-badges == 'true' && always()
      run: |  
        if [ test -d "${{ inputs.badge-directory }}" ]; then
          echo "::notice file=action.yml,line=170::Badge directory exists: ${{ inputs.badge-directory }}"
        else
          echo "::notice file=action.yml,line=172::Badge directory does not exist. Creating it now."
          mkdir -p "${{ inputs.badge-directory }}" && echo "::notice file=action.yml,line=174::Badge directory created successfully." || { echo "::error file=action.yml,line=175::Failed to create badge directory."; exit 1; }
        fi

        echo "::notice file=action.yml, line=320::Defining function to create SVG badges."
        # Function to create badge
        create_badge() {
          local name=$1
          local status=$2
          local color=$3
          local file=$4
          
          cat > "$file" << 'EOF'
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="120" height="20">
          <linearGradient id="b" x2="0" y2="100%">
            <stop offset="0" stop-color="#bbb" stop-opacity=".1"/>
            <stop offset="1" stop-opacity=".1"/>
          </linearGradient>
          <clipPath id="a">
            <rect width="120" height="20" rx="3" fill="#fff"/>
          </clipPath>
          <g clip-path="url(#a)">
            <path fill="#555" d="M0 0h60v20H0z"/>
            <path fill="COLOR" d="M60 0h60v20H60z"/>
            <path fill="url(#b)" d="M0 0h120v20H0z"/>
          </g>
          <g fill="#fff" text-anchor="middle" font-family="DejaVu Sans,Verdana,Geneva,sans-serif" font-size="11">
            <text x="30" y="15" fill="#010101" fill-opacity=".3">NAME</text>
            <text x="30" y="14">NAME</text>
            <text x="90" y="15" fill="#010101" fill-opacity=".3">STATUS</text>
            <text x="90" y="14">STATUS</text>
          </g>
        </svg>
        EOF
            sed -i "s/NAME/$name/g; s/STATUS/$status/g; s/COLOR/$color/g" "$file"
          }
          
        # Determine badge status based on exit codes
        PYLINT_STATUS="${{ steps.run-pylint.outcome }}"
        PYLINT_COLOR="#4c1"
        [ "${PYLINT_STATUS}" != "success" ] && PYLINT_COLOR="#e05d44"

        echo "::notice file=action.yml,line=186::Pylint status: $PYLINT_STATUS, color: $PYLINT_COLOR"
        
        BLACK_STATUS="${{ steps.run-black.outcome }}"
        BLACK_COLOR="#4c1"
        [ "${BLACK_STATUS}" != "success" ] && BLACK_COLOR="#e05d44"

        echo "::notice file=action.yml,line=192::Black status: $BLACK_STATUS, color: $BLACK_COLOR"
        
        MYPY_STATUS="${{ steps.run-mypy.outcome }}"
        MYPY_COLOR="#4c1"
        [ "${MYPY_STATUS}" != "success" ] && MYPY_COLOR="#e05d44"
        
        echo "::notice file=action.yml,line=198::MyPy status: $MYPY_STATUS, color: $MYPY_COLOR"

        # Create badges for each tool with actual status
        echo "::notice file=action.yml,line=203::Generating SVG badge pylint.svg"
        create_badge "pylint" "$PYLINT_STATUS" "$PYLINT_COLOR" "${{ inputs.badge-directory }}/pylint.svg" && echo "::notice file=action.yml,line=204::Pylint badge created successfully." || { echo "::error file=action.yml,line=204::Failed to create pylint badge."; exit 1; }
        
        echo "::notice file=action.yml,line=206::Generating SVG badge black.svg"
        create_badge "black" "$BLACK_STATUS" "$BLACK_COLOR" "${{ inputs.badge-directory }}/black.svg" && echo "::notice file=action.yml,line=207::Black badge created successfully." || { echo "::error file=action.yml,line=207::Failed to create black badge."; exit 1; }
        
        echo "::notice file=action.yml,line=209::Generating SVG badge mypy.svg"
        create_badge "mypy" "$MYPY_STATUS" "$MYPY_COLOR" "${{ inputs.badge-directory }}/mypy.svg" && echo "::notice file=action.yml,line=210::MyPy badge created successfully." || { echo "::error file=action.yml,line=210::Failed to create mypy badge."; exit 1; }
        
        echo "::notice file=action.yml,line=212::SVG badge generation completed."
      shell: bash
      continue-on-error: true

    - name: Update README with Badges
      id: update-readme
      if: steps.generate-badges.outcome == 'success' && inputs.update-readme == 'true'
      run: |
        README_FILE="${{ inputs.readme-path }}"
        BADGE_DIR="${{ inputs.badge-directory }}"
        BADGE_STYLE="${{ inputs.badge-style }}"
        
        echo "::notice file=action.yml,line=398::Updating README with badge references"
        
        # Check if README exists
        if [ ! -f "$README_FILE" ]; then
          echo "::warning file=action.yml,line=402::README file not found: $README_FILE"
          exit 0
        fi
        
        # Define badge markers
        MARKER_START="<!-- LINTING-BADGES-START -->"
        MARKER_END="<!-- LINTING-BADGES-END -->"
        
        # Generate badge references based on style
        if [ "$BADGE_STYLE" == "url" ]; then
          # Use GitHub raw URLs
          REPO="${{ github.repository }}"
          BRANCH="${{ github.ref_name }}"
          PYLINT_BADGE="![Pylint](https://raw.githubusercontent.com/$REPO/$BRANCH/$BADGE_DIR/pylint.svg)"
          BLACK_BADGE="![Black](https://raw.githubusercontent.com/$REPO/$BRANCH/$BADGE_DIR/black.svg)"
          MYPY_BADGE="![MyPy](https://raw.githubusercontent.com/$REPO/$BRANCH/$BADGE_DIR/mypy.svg)"
        else
          # Use relative paths
          PYLINT_BADGE="![Pylint]($BADGE_DIR/pylint.svg)"
          BLACK_BADGE="![Black]($BADGE_DIR/black.svg)"
          MYPY_BADGE="![MyPy]($BADGE_DIR/mypy.svg)"
        fi
        
        # Check if markers exist
        if grep -q "$MARKER_START" "$README_FILE" && grep -q "$MARKER_END" "$README_FILE"; then
          echo "::notice file=action.yml,line=426::Updating existing badge section in README"
          
          # Create badge content
          BADGE_CONTENT="$MARKER_START\n$PYLINT_BADGE\n$BLACK_BADGE\n$MYPY_BADGE\n$MARKER_END"
          
          # Replace content between markers using awk
          awk -v start="$MARKER_START" -v end="$MARKER_END" -v content="$BADGE_CONTENT" '
            $0 ~ start {print content; skip=1; next}
            $0 ~ end {skip=0; next}
            !skip
          ' "$README_FILE" > "${README_FILE}.tmp"
          
          mv "${README_FILE}.tmp" "$README_FILE"
          echo "::notice file=action.yml,line=438::README updated successfully"
        else
          echo "::notice file=action.yml,line=440::Badge markers not found in README. Adding badges after title."
          
          # Insert badges after the first title (# heading)
          BADGE_SECTION="\n$MARKER_START\n$PYLINT_BADGE\n$BLACK_BADGE\n$MYPY_BADGE\n$MARKER_END\n"
          
          # Use awk to insert after first # heading
          awk -v section="$BADGE_SECTION" '
            !inserted && /^# / {print; print section; inserted=1; next}
            {print}
          ' "$README_FILE" > "${README_FILE}.tmp"
          
          mv "${README_FILE}.tmp" "$README_FILE"
          echo "::notice file=action.yml,line=452::Badges added to README successfully"
        fi
      shell: bash
      continue-on-error: true

    - name: Commit Badges To Repository
      id: commit-badges
      if: steps.generate-badges.outcome == 'success'
      run: |
        # Configure git
        git config --local user.email "github-actions[bot]@users.noreply.github.com" && echo "::notice file=action.yml,line=253::Git user email set successfully." || { echo "::warning file=action.yml,line=254::Failed to set git user email."; exit 134; }
        git config --local user.name "github-actions[bot]" && echo "::notice file=action.yml,line=257::Git user name set successfully." || { echo "::warning file=action.yml,line=258::Failed to set git user name."; exit 134; }

        # Rebase to latest
        git pull --rebase origin ${{ github.ref }} && echo "::notice file=action.yml,line=266::Rebased to latest changes from remote." || { echo "::warning file=action.yml,line=267::Failed to rebase from remote."; exit 1; }

        # Check if badge directory exists
        test -d "${{ inputs.badge-directory }}" && echo "::notice file=action.yml,line=263::Badge directory ${{ inputs.badge-directory }} exists." || { echo "::warning file=action.yml,line=264::Badge directory ${{ inputs.badge-directory }} does not exist. Skipping badge commit."; exit 0; } 

        # Add and commit badges
        git add "${{ inputs.badge-directory }}/pylint.svg" && echo "::notice file=action.yml,line=267::Adding pylint badge to commit." || { echo "::warning file=action.yml,line=268::Failed to add pylint badge."; }
        git add "${{ inputs.badge-directory }}/black.svg" && echo "::notice file=action.yml,line=270::Adding black badge to commit." || { echo "::warning file=action.yml,line=271::Failed to add black badge."; }
        git add "${{ inputs.badge-directory }}/mypy.svg" && echo "::notice file=action.yml,line=273::Adding mypy badge to commit." || { echo "::warning file=action.yml,line=274::Failed to add mypy badge."; }
        
        # Add README if it was updated
        if [ "${{ inputs.update-readme }}" == "true" ] && [ "${{ steps.update-readme.outcome }}" == "success" ]; then
          git add "${{ inputs.readme-path }}" && echo "::notice file=action.yml,line=276::Adding README to commit." || { echo "::warning file=action.yml,line=277::Failed to add README."; }
        fi
        
        git commit -m "Update linting badges [skip ci]" && echo "::notice file=action.yml,line=302::Committing changes to repository." || { echo "::warning file=action.yml,line=303::No changes to commit."; exit 0; }
        
        # Push changes to repository
        git push origin ${{ github.ref }} && echo "::notice file=action.yml,line=306::Pushing changes to repository." || { echo "::warning file=action.yml,line=307::Failed to push changes to repository."; exit 1; }
      shell: bash
      continue-on-error: true

    - name: Badge Generation Failure
      if: steps.generate-badges.outcome == 'failure'
      run: |
        echo "::error file=action.yml,line=313::Failed to generate SVG badges."
        exit 1
      shell: bash

    - name: Badge Commit Failure
      if: steps.commit-badges.outcome == 'failure'
      run: |
        echo "::error file=action.yml,line=314::Failed to commit or push badges to the repository."
        exit 1
      shell: bash


